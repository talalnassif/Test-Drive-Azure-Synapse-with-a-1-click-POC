{
	"name": "SQL Navision - G215 OM West - incremental",
	"properties": {
		"folder": {
			"name": "SQL"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "AzureDataLakeStorage1",
						"type": "LinkedServiceReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "AzureSynapseAnalytics1",
						"type": "LinkedServiceReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Select1"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "AlterRow1"
				}
			],
			"script": "parameters{\n\tcols as string[] ([\"Entry No_\"])\n}\nsource(output(\n\t\t{__$start_lsn} as string,\n\t\t{__$seqval} as string,\n\t\t{__$operation} as short,\n\t\t{__$update_mask} as string,\n\t\ttimestamp as string,\n\t\t{Entry No_} as integer,\n\t\t{G_L Account No_} as integer,\n\t\t{Posting Date} as string,\n\t\t{Document Type} as boolean,\n\t\t{Document No_} as string,\n\t\tDescription as string,\n\t\t{Bal_ Account No_} as integer,\n\t\tAmount as double,\n\t\t{Global Dimension 1 Code} as integer,\n\t\t{Global Dimension 2 Code} as string,\n\t\t{User ID} as string,\n\t\t{Source Code} as string,\n\t\t{System-Created Entry} as boolean,\n\t\t{Prior-Year Entry} as boolean,\n\t\t{Job No_} as integer,\n\t\tQuantity as double,\n\t\t{VAT Amount} as double,\n\t\t{Business Unit Code} as string,\n\t\t{Journal Batch Name} as string,\n\t\t{Reason Code} as string,\n\t\t{Gen_ Posting Type} as boolean,\n\t\t{Gen_ Bus_ Posting Group} as string,\n\t\t{Gen_ Prod_ Posting Group} as string,\n\t\t{Bal_ Account Type} as boolean,\n\t\t{Transaction No_} as integer,\n\t\t{Debit Amount} as double,\n\t\t{Credit Amount} as double,\n\t\t{Document Date} as string,\n\t\t{External Document No_} as string,\n\t\t{Source Type} as boolean,\n\t\t{Source No_} as string,\n\t\t{No_ Series} as string,\n\t\t{Tax Area Code} as string,\n\t\t{Tax Liable} as boolean,\n\t\t{Tax Group Code} as string,\n\t\t{Use Tax} as boolean,\n\t\t{VAT Bus_ Posting Group} as string,\n\t\t{VAT Prod_ Posting Group} as string,\n\t\t{Additional-Currency Amount} as double,\n\t\t{Add_-Currency Debit Amount} as double,\n\t\t{Add_-Currency Credit Amount} as double,\n\t\t{Close Income Statement Dim_ ID} as boolean,\n\t\t{IC Partner Code} as string,\n\t\tReversed as boolean,\n\t\t{Reversed by Entry No_} as boolean,\n\t\t{Reversed Entry No_} as boolean,\n\t\t{Dimension Set ID} as short,\n\t\t{Prod_ Order No_} as string,\n\t\t{FA Entry Type} as boolean,\n\t\t{FA Entry No_} as boolean,\n\t\t{STE Transaction ID} as string,\n\t\tGST_HST as boolean,\n\t\t{Order No_} as string,\n\t\t{Document Line No_} as boolean,\n\t\t{Check No_} as string,\n\t\t{Voucher Description} as string,\n\t\t{VAT To Ref Contact Type} as boolean,\n\t\t{VAT To Ref Contact Code} as string,\n\t\t{Before Document No_} as string,\n\t\t{VAT-to Direct} as string,\n\t\t{Document No_ Before Post} as string,\n\t\t{Unrealized VAT Entry No_} as boolean,\n\t\t{Document No_ Before Posted} as string,\n\t\t{Voucher Remark 1} as string,\n\t\t{Voucher Remark 2} as string,\n\t\t{Voucher Remark 3} as string,\n\t\t{Voucher Remark 4} as string,\n\t\t{Voucher Remark 5} as string,\n\t\t{Voucher Remark 6} as string,\n\t\t{Voucher Remark 7} as string,\n\t\t{Voucher Remark 8} as string,\n\t\t{Voucher Remark 9} as string,\n\t\t{Voucher Remark 10} as string,\n\t\t{Pay-to_Receive from Direct} as string,\n\t\t{Payment Term Code} as string,\n\t\t{Due Date} as string,\n\t\t{Currency Code} as string,\n\t\t{Currency Factor} as double,\n\t\t{Job task no_} as string,\n\t\t{Is Merge Source Type} as boolean,\n\t\t{Is Merge Bal Account Type} as boolean,\n\t\t{Change From Source Name} as string,\n\t\t{Merged From Bal Account} as string,\n\t\t{Merged from Source Account} as string,\n\t\t{Is Merge GLAccNo} as boolean,\n\t\t{Merge from GLAccNo} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'delimited',\n\tfileSystem: 'raw',\n\tfolderPath: 'Navision/Incremental/G215 OM West$G_L Entry/2021/11/30',\n\tfileName: '20211130120000000.csv',\n\tcolumnDelimiter: ',',\n\tescapeChar: '\\\\',\n\tquoteChar: '\\\"',\n\tcolumnNamesAsHeader: true) ~> source1\nsource1 select(mapColumn(\n\t\ttimestamp,\n\t\t{Entry No_},\n\t\t{G_L Account No_},\n\t\t{Posting Date},\n\t\t{Document Type},\n\t\t{Document No_},\n\t\tDescription,\n\t\t{Bal_ Account No_},\n\t\tAmount,\n\t\t{Global Dimension 1 Code},\n\t\t{Global Dimension 2 Code},\n\t\t{User ID},\n\t\t{Source Code},\n\t\t{System-Created Entry},\n\t\t{Prior-Year Entry},\n\t\t{Job No_},\n\t\tQuantity,\n\t\t{VAT Amount},\n\t\t{Business Unit Code},\n\t\t{Journal Batch Name},\n\t\t{Reason Code},\n\t\t{Gen_ Posting Type},\n\t\t{Gen_ Bus_ Posting Group},\n\t\t{Gen_ Prod_ Posting Group},\n\t\t{Bal_ Account Type},\n\t\t{Transaction No_},\n\t\t{Debit Amount},\n\t\t{Credit Amount},\n\t\t{Document Date},\n\t\t{External Document No_},\n\t\t{Source Type},\n\t\t{Source No_},\n\t\t{No_ Series},\n\t\t{Tax Area Code},\n\t\t{Tax Liable},\n\t\t{Tax Group Code},\n\t\t{Use Tax},\n\t\t{VAT Bus_ Posting Group},\n\t\t{VAT Prod_ Posting Group},\n\t\t{Additional-Currency Amount},\n\t\t{Add_-Currency Debit Amount},\n\t\t{Add_-Currency Credit Amount},\n\t\t{Close Income Statement Dim_ ID},\n\t\t{IC Partner Code},\n\t\tReversed,\n\t\t{Reversed by Entry No_},\n\t\t{Reversed Entry No_},\n\t\t{Dimension Set ID},\n\t\t{Prod_ Order No_},\n\t\t{FA Entry Type},\n\t\t{FA Entry No_},\n\t\t{STE Transaction ID},\n\t\tGST_HST,\n\t\t{Order No_},\n\t\t{Document Line No_},\n\t\t{Check No_},\n\t\t{Voucher Description},\n\t\t{VAT To Ref Contact Type},\n\t\t{VAT To Ref Contact Code},\n\t\t{Before Document No_},\n\t\t{VAT-to Direct},\n\t\t{Document No_ Before Post},\n\t\t{Unrealized VAT Entry No_},\n\t\t{Document No_ Before Posted},\n\t\t{Voucher Remark 1},\n\t\t{Voucher Remark 2},\n\t\t{Voucher Remark 3},\n\t\t{Voucher Remark 4},\n\t\t{Voucher Remark 5},\n\t\t{Voucher Remark 6},\n\t\t{Voucher Remark 7},\n\t\t{Voucher Remark 8},\n\t\t{Voucher Remark 9},\n\t\t{Voucher Remark 10},\n\t\t{Pay-to_Receive from Direct},\n\t\t{Payment Term Code},\n\t\t{Due Date},\n\t\t{Currency Code},\n\t\t{Currency Factor},\n\t\t{Job task no_},\n\t\t{Is Merge Source Type},\n\t\t{Is Merge Bal Account Type},\n\t\t{Change From Source Name},\n\t\t{Merged From Bal Account},\n\t\t{Merged from Source Account},\n\t\t{Is Merge GLAccNo},\n\t\t{Merge from GLAccNo}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(last_update_tmstp = currentUTC(),\n\t\tsource_system = 'G215 OM West') ~> DerivedColumn1\nDerivedColumn1 alterRow(upsertIf(true())) ~> AlterRow1\nAlterRow1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'table',\n\tstore: 'synapseanalytics',\n\tschemaName: 'dbo',\n\ttableName: 'G215OMWest',\n\tinsertable: false,\n\tupdateable: false,\n\tdeletable: false,\n\tupsertable: true,\n\tkeys:($cols),\n\tstaged: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sink1"
		}
	}
}